<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html>
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="
        width=device-width,
        initial-scale=1.0,
        minimum-scale=1.0,
        maximum-scale=1.0,
        user-scalable=no">
        <title>kabi novel</title>
        <!-- inject:css -->
        <style>
            .page,body,html {
                position: relative;
                height: 100%;
                width: 100%
            }

            body,html {
                overflow: hidden;
                margin: 0;
                padding: 0;
                background-color: #fff;
                font-size: 20px;
                line-height: 24px
            }

            body *,html * {
                box-sizing: border-box
            }

            body .button,html .button {
                min-width: 100px;
                padding: 0 0px;
                font-size: 40px;
                display: inline-block;
                border: 1px solid #333;
                text-align: center;
                justify-content: center
            }

            .page {
                display: none
            }

            .page.show {
                display: block
            }

            .page .content {
                padding: 10px 15px 10px 10px
            }

            .page .content .pagination-box {
                height: 100%;
                overflow: hidden
            }

            .page .content .pagination-box .pagination-body {
                min-height: 100%
            }

            .page .current-info {
                height: 20px;
                padding: 0 20px;
                line-height: 20px
            }

            .page .bar {
                height: 50px;
                position: absolute;
                bottom: 180px;
                width: 100%;
                background-color: #666;
                text-align: center
            }

            .page .bar .bar-progress {
                display: inline-block;
                height: 100%;
                background-color: #000;
                float: left
            }

            .page .bar .bar-text {
                position: absolute;
                width: 100%;
                height: 100%;
                line-height: 50px;
                color: #fff
            }

            .page .control {
                height: 180px;
                background-color: #eee;
                position: absolute;
                bottom: 0;
                width: 100%;
                padding-top: 20px
            }

            .page .control .left-box {
                float: left
            }

            .config .content .right,.page .control .right-box {
                float: left
            }

            .page .control .button {
                line-height: 100px;
                height: 100%;
                margin: 0 10px
            }

            .article .content .content-inner>p {
                margin: 0;
                text-indent: 2em
            }

            .catalogue .article-list {
                font-size: 0
            }

            .catalogue .article-list .article-item {
                display: inline-block;
                width: 50%;
                font-size: 40px;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
                vertical-align: middle;
                color: #999;
                padding: 0 10px
            }

            .catalogue .article-list .article-item.current {
                color: #fff!important;
                background-color: #000
            }

            .catalogue .article-list .article-item.cached {
                color: #000;
                font-weight: 700
            }

            .bookshelf .book-list {
                font-size: 0
            }

            .bookshelf .book-list .book-item {
                display: inline-block;
                width: 50%;
                padding: 10px;
                min-height: 200px;
                vertical-align: middle;
                font-size: 24px;
                line-height: 40px;
                margin: 0
            }

            .bookshelf .book-list .book-item .book-cover {
                display: inline-block;
                height: 100%;
                border: 1px solid #ccc;
                background-size: 100%;
                background-position: center;
                vertical-align: middle
            }

            .bookshelf .book-list .book-item .book-cover img {
                width: 100%;
                height: 100%
            }

            .bookshelf .book-list .book-item .book-info {
                display: inline-block;
                height: 100%;
                padding: 10px;
                vertical-align: middle
            }

            .bookshelf .book-list .book-item .book-info>div {
                overflow: hidden;
                text-overflow: ellipsis;
                white-space: nowrap
            }

            .bookshelf .book-list .book-item .book-info>div:first-child {
                font-size: 32px;
                font-weight: 700
            }

            .config .content {
                padding: 20px 40px;
                font-size: 30px;
                line-height: 40px;
                height: 100%
            }

            .config .content .button {
                margin-left: 10px
            }

            .config .form-item {
                padding: 10px 0
            }

            .config .form-item .label::after {
                content: "："
            }

            .config .form-item .text {
                line-height: 60px
            }

            .config .form-item .text input {
                font-size: 50px;
                line-height: 60px;
                width: 70%
            }

            .config .form-item.display .text {
                height: 500px;
                border: 1px solid #333;
                padding: 10px;
                line-height: 20px;
                font-size: 16px;
                overflow: hidden
            }

            .config .form-item.display .text p {
                margin: 0;
                text-indent: 2em
            }

            .modal-box .modal {
                position: absolute;
                min-width: 600px;
                min-height: 600px;
                left: 50px;
                right: 50px;
                top: 40%;
                margin-top: -400px;
                border: 1px solid #ccc;
                background-color: #fff
            }

            .modal-box .modal .modal-content {
                min-height: 500px;
                padding: 10px;
                word-break: break-all;
                font-size: 20px;
                line-height: 40px
            }

            .modal-box .modal .modal-content * {
                word-break: break-all
            }

            .modal-box .modal .modal-footer {
                height: 100px;
                text-align: center;
                border-top: 1px solid #ccc;
                line-height: 100px
            }

            .modal-box .modal .modal-footer .button {
                height: 90px;
                margin: 0 20px;
                vertical-align: middle;
                line-height: 90px
            }

            .message-box {
                position: fixed;
                top: 0;
                left: 0;
                right: 0
            }

            .message-box .message {
                text-align: center;
                padding: 5px
            }

            .message-box .message .message-content {
                display: inline-block;
                height: 60px;
                background-color: #666;
                font-size: 50px;
                line-height: 60px;
                color: #fff;
                border-radius: 8px
            }
        </style>
        <!-- endinject -->
        <!-- inject:js -->
        <script>
            !function o(i, r, c) {
                function a(e, t) {
                    if (!r[e]) {
                        if (!i[e]) {
                            var n = "function" == typeof require && require;
                            if (!t && n)
                                return n(e, !0);
                            if (s)
                                return s(e, !0);
                            throw (t = new Error("Cannot find module '" + e + "'")).code = "MODULE_NOT_FOUND",
                            t
                        }
                        n = r[e] = {
                            exports: {}
                        },
                        i[e][0].call(n.exports, function(t) {
                            return a(i[e][1][t] || t)
                        }, n, n.exports, o, i, r, c)
                    }
                    return r[e].exports
                }
                for (var s = "function" == typeof require && require, t = 0; t < c.length; t++)
                    a(c[t]);
                return a
            }({
                1: [function(t, e, n) {
                    m = String.fromCharCode,
                    o = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
                    i = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",
                    r = {};
                    var m, o, i, r, c, a = c = {
                        compressToBase64: function(t) {
                            if (null == t)
                                return "";
                            var e = c._compress(t, 6, function(t) {
                                return o.charAt(t)
                            });
                            switch (e.length % 4) {
                            default:
                            case 0:
                                return e;
                            case 1:
                                return e + "===";
                            case 2:
                                return e + "==";
                            case 3:
                                return e + "="
                            }
                        },
                        decompressFromBase64: function(e) {
                            return null == e ? "" : "" == e ? null : c._decompress(e.length, 32, function(t) {
                                return s(o, e.charAt(t))
                            })
                        },
                        compressToUTF16: function(t) {
                            return null == t ? "" : c._compress(t, 15, function(t) {
                                return m(t + 32)
                            }) + " "
                        },
                        decompressFromUTF16: function(e) {
                            return null == e ? "" : "" == e ? null : c._decompress(e.length, 16384, function(t) {
                                return e.charCodeAt(t) - 32
                            })
                        },
                        compressToUint8Array: function(t) {
                            for (var e = c.compress(t), n = new Uint8Array(2 * e.length), o = 0, i = e.length; o < i; o++) {
                                var r = e.charCodeAt(o);
                                n[2 * o] = r >>> 8,
                                n[2 * o + 1] = r % 256
                            }
                            return n
                        },
                        decompressFromUint8Array: function(t) {
                            if (null == t)
                                return c.decompress(t);
                            for (var e = new Array(t.length / 2), n = 0, o = e.length; n < o; n++)
                                e[n] = 256 * t[2 * n] + t[2 * n + 1];
                            var i = [];
                            return e.forEach(function(t) {
                                i.push(m(t))
                            }),
                            c.decompress(i.join(""))
                        },
                        compressToEncodedURIComponent: function(t) {
                            return null == t ? "" : c._compress(t, 6, function(t) {
                                return i.charAt(t)
                            })
                        },
                        decompressFromEncodedURIComponent: function(e) {
                            return null == e ? "" : "" == e ? null : (e = e.replace(/ /g, "+"),
                            c._decompress(e.length, 32, function(t) {
                                return s(i, e.charAt(t))
                            }))
                        },
                        compress: function(t) {
                            return c._compress(t, 16, function(t) {
                                return m(t)
                            })
                        },
                        _compress: function(t, e, n) {
                            if (null == t)
                                return "";
                            for (var o, i, r, c, a = {}, s = {}, l = "", u = 2, d = 3, h = 2, p = [], g = 0, f = 0, w = 0; w < t.length; w += 1)
                                if (r = t.charAt(w),
                                Object.prototype.hasOwnProperty.call(a, r) || (a[r] = d++,
                                s[r] = !0),
                                c = l + r,
                                Object.prototype.hasOwnProperty.call(a, c))
                                    l = c;
                                else {
                                    if (Object.prototype.hasOwnProperty.call(s, l)) {
                                        if (l.charCodeAt(0) < 256) {
                                            for (o = 0; o < h; o++)
                                                g <<= 1,
                                                f == e - 1 ? (f = 0,
                                                p.push(n(g)),
                                                g = 0) : f++;
                                            for (i = l.charCodeAt(0),
                                            o = 0; o < 8; o++)
                                                g = g << 1 | 1 & i,
                                                f == e - 1 ? (f = 0,
                                                p.push(n(g)),
                                                g = 0) : f++,
                                                i >>= 1
                                        } else {
                                            for (i = 1,
                                            o = 0; o < h; o++)
                                                g = g << 1 | i,
                                                f == e - 1 ? (f = 0,
                                                p.push(n(g)),
                                                g = 0) : f++,
                                                i = 0;
                                            for (i = l.charCodeAt(0),
                                            o = 0; o < 16; o++)
                                                g = g << 1 | 1 & i,
                                                f == e - 1 ? (f = 0,
                                                p.push(n(g)),
                                                g = 0) : f++,
                                                i >>= 1
                                        }
                                        0 == --u && (u = Math.pow(2, h),
                                        h++),
                                        delete s[l]
                                    } else
                                        for (i = a[l],
                                        o = 0; o < h; o++)
                                            g = g << 1 | 1 & i,
                                            f == e - 1 ? (f = 0,
                                            p.push(n(g)),
                                            g = 0) : f++,
                                            i >>= 1;
                                    0 == --u && (u = Math.pow(2, h),
                                    h++),
                                    a[c] = d++,
                                    l = String(r)
                                }
                            if ("" !== l) {
                                if (Object.prototype.hasOwnProperty.call(s, l)) {
                                    if (l.charCodeAt(0) < 256) {
                                        for (o = 0; o < h; o++)
                                            g <<= 1,
                                            f == e - 1 ? (f = 0,
                                            p.push(n(g)),
                                            g = 0) : f++;
                                        for (i = l.charCodeAt(0),
                                        o = 0; o < 8; o++)
                                            g = g << 1 | 1 & i,
                                            f == e - 1 ? (f = 0,
                                            p.push(n(g)),
                                            g = 0) : f++,
                                            i >>= 1
                                    } else {
                                        for (i = 1,
                                        o = 0; o < h; o++)
                                            g = g << 1 | i,
                                            f == e - 1 ? (f = 0,
                                            p.push(n(g)),
                                            g = 0) : f++,
                                            i = 0;
                                        for (i = l.charCodeAt(0),
                                        o = 0; o < 16; o++)
                                            g = g << 1 | 1 & i,
                                            f == e - 1 ? (f = 0,
                                            p.push(n(g)),
                                            g = 0) : f++,
                                            i >>= 1
                                    }
                                    0 == --u && (u = Math.pow(2, h),
                                    h++),
                                    delete s[l]
                                } else
                                    for (i = a[l],
                                    o = 0; o < h; o++)
                                        g = g << 1 | 1 & i,
                                        f == e - 1 ? (f = 0,
                                        p.push(n(g)),
                                        g = 0) : f++,
                                        i >>= 1;
                                0 == --u && (u = Math.pow(2, h),
                                h++)
                            }
                            for (i = 2,
                            o = 0; o < h; o++)
                                g = g << 1 | 1 & i,
                                f == e - 1 ? (f = 0,
                                p.push(n(g)),
                                g = 0) : f++,
                                i >>= 1;
                            for (; ; ) {
                                if (g <<= 1,
                                f == e - 1) {
                                    p.push(n(g));
                                    break
                                }
                                f++
                            }
                            return p.join("")
                        },
                        decompress: function(e) {
                            return null == e ? "" : "" == e ? null : c._decompress(e.length, 32768, function(t) {
                                return e.charCodeAt(t)
                            })
                        },
                        _decompress: function(t, e, n) {
                            for (var o, i, r, c, a, s, l = [], u = 4, d = 4, h = 3, p = "", g = [], f = {
                                val: n(0),
                                position: e,
                                index: 1
                            }, w = 0; w < 3; w += 1)
                                l[w] = w;
                            for (i = 0,
                            c = Math.pow(2, 2),
                            a = 1; a != c; )
                                r = f.val & f.position,
                                f.position >>= 1,
                                0 == f.position && (f.position = e,
                                f.val = n(f.index++)),
                                i |= (0 < r ? 1 : 0) * a,
                                a <<= 1;
                            switch (i) {
                            case 0:
                                for (i = 0,
                                c = Math.pow(2, 8),
                                a = 1; a != c; )
                                    r = f.val & f.position,
                                    f.position >>= 1,
                                    0 == f.position && (f.position = e,
                                    f.val = n(f.index++)),
                                    i |= (0 < r ? 1 : 0) * a,
                                    a <<= 1;
                                s = m(i);
                                break;
                            case 1:
                                for (i = 0,
                                c = Math.pow(2, 16),
                                a = 1; a != c; )
                                    r = f.val & f.position,
                                    f.position >>= 1,
                                    0 == f.position && (f.position = e,
                                    f.val = n(f.index++)),
                                    i |= (0 < r ? 1 : 0) * a,
                                    a <<= 1;
                                s = m(i);
                                break;
                            case 2:
                                return ""
                            }
                            for (o = l[3] = s,
                            g.push(s); ; ) {
                                if (t < f.index)
                                    return "";
                                for (i = 0,
                                c = Math.pow(2, h),
                                a = 1; a != c; )
                                    r = f.val & f.position,
                                    f.position >>= 1,
                                    0 == f.position && (f.position = e,
                                    f.val = n(f.index++)),
                                    i |= (0 < r ? 1 : 0) * a,
                                    a <<= 1;
                                switch (s = i) {
                                case 0:
                                    for (i = 0,
                                    c = Math.pow(2, 8),
                                    a = 1; a != c; )
                                        r = f.val & f.position,
                                        f.position >>= 1,
                                        0 == f.position && (f.position = e,
                                        f.val = n(f.index++)),
                                        i |= (0 < r ? 1 : 0) * a,
                                        a <<= 1;
                                    l[d++] = m(i),
                                    s = d - 1,
                                    u--;
                                    break;
                                case 1:
                                    for (i = 0,
                                    c = Math.pow(2, 16),
                                    a = 1; a != c; )
                                        r = f.val & f.position,
                                        f.position >>= 1,
                                        0 == f.position && (f.position = e,
                                        f.val = n(f.index++)),
                                        i |= (0 < r ? 1 : 0) * a,
                                        a <<= 1;
                                    l[d++] = m(i),
                                    s = d - 1,
                                    u--;
                                    break;
                                case 2:
                                    return g.join("")
                                }
                                if (0 == u && (u = Math.pow(2, h),
                                h++),
                                l[s])
                                    p = l[s];
                                else {
                                    if (s !== d)
                                        return null;
                                    p = o + o.charAt(0)
                                }
                                g.push(p),
                                l[d++] = o + p.charAt(0),
                                o = p,
                                0 == --u && (u = Math.pow(2, h),
                                h++)
                            }
                        }
                    };
                    function s(t, e) {
                        if (!r[t]) {
                            r[t] = {};
                            for (var n = 0; n < t.length; n++)
                                r[t][t.charAt(n)] = n
                        }
                        return r[t][e]
                    }
                    "function" == typeof define && define.amd ? define(function() {
                        return a
                    }) : void 0 !== e && null != e ? e.exports = a : "undefined" != typeof angular && null != angular && angular.module("LZString", []).factory("LZString", function() {
                        return a
                    })
                }
                , {}],
                2: [function(t, e, n) {
                    "use strict";
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    });
                    var c = t("../common/bar/bar")
                      , r = t("../common/common")
                      , a = t("../common/pagination/pagination");
                    function o() {
                        function t() {
                            var t;
                            return "".concat(null == (t = o.currentBook) ? void 0 : t.name, " - ").concat(null == (t = o.currentBook) ? void 0 : t.author, " - ").concat(null == (t = o.progress) ? void 0 : t.title)
                        }
                        function e() {
                            var t = window.Store.get("current");
                            o.currentBook = window.BookShelf.bookMap[t],
                            o.currentBook ? (window.Layout.lineHeight = window.Layout.lineHeight,
                            o.catalogue = window.Store.getObj("c_".concat(t)) || [],
                            o.progress = window.Store.getObj("p_".concat(o.currentBook.id)),
                            o.getContent()) : "article" === window.Router.current && window.Router.go("bookshelf")
                        }
                        var o = this
                          , i = (this.catalogue = [],
                        this.loading = !1,
                        this.element = document.querySelector(".page.article"),
                        this.pagination = new a.default({
                            root: this.element.querySelector(".content")
                        }),
                        this.bar = new c.default({
                            element: this.element.querySelector(".bar"),
                            pagination: this.pagination
                        }),
                        window.Bind.bindView(this.element.querySelector(".content-inner"), this, "content", function(t) {
                            var e;
                            return t ? (e = "\n                <style>\n                </style>\n            ",
                            t.split("\n").map(function(t) {
                                return t.trim()
                            }).filter(function(t) {
                                return !!t
                            }).forEach(function(t) {
                                e += "\n                    <p>".concat(t, "</p>\n                ")
                            }),
                            window.setTimeout(function() {
                                o.pagination.checkPage(),
                                o.setPageByProgress()
                            }),
                            e) : ""
                        }),
                        window.Bind.bind(this, "progress", function(t, e) {
                            e && (window.Store.setObj("p_".concat(o.currentBook.id), t),
                            o.progress.pos > o.content.length || window.Api.saveProgress(o.currentBook, o.progress))
                        }),
                        this.element.querySelector(".current-info"))
                          , n = (window.Bind.bindView(i, this, "currentBook", t),
                        window.Bind.bindView(i, this, "progress", t),
                        window.Bind.bindView(i, this, "catalogue", t),
                        this.element.querySelector(".content"))
                          , r = n.querySelector(".content-inner");
                        window.Bind.bindStyle(r, window.Layout, "fontSize", "fontSize", function(t) {
                            return "".concat(t, "px")
                        }),
                        window.Bind.bindStyle(r, window.Layout, "lineHeight", "lineHeight", function(t) {
                            return "".concat(t, "px")
                        }),
                        window.Bind.bindStyle(n, window.Layout, "lineHeight", "height", function(t) {
                            var e, n;
                            return o.element.offsetHeight ? ((e = (n = o.element.offsetHeight - 230 - 20) % window.Layout.lineHeight) < 10 && (e += window.Layout.lineHeight),
                            n = n - e + 20,
                            i.style.height = "".concat(e, "px"),
                            i.style.lineHeight = "".concat(e, "px"),
                            window.setTimeout(function() {
                                return o.pagination.checkPage()
                            }),
                            "".concat(n, "px")) : ""
                        });
                        (window.Router.cbMap.article = e)()
                    }
                    o.prototype.getContent = function() {
                        this.content = window.Store.get("a_".concat(this.currentBook.id, "_").concat(this.progress.index)) || "";
                        function t() {
                            window.setTimeout(function() {
                                var t;
                                null != (t = window.Catalogue) && t.doCache(5)
                            })
                        }
                        this.content ? t() : this.getArticle(t)
                    }
                    ,
                    o.prototype.pageChange = function(t) {
                        var e, n = this.pagination.pageIndex + t;
                        n < 0 || n >= this.pagination.pageLimit ? (e = this.progress.index + t,
                        t = -1 === t ? 999999999999 : 0,
                        this.progress = (0,
                        r.changeValueWithNewObj)(this.progress, {
                            index: e,
                            //title: this.catalogue[e].title,
                            time: (new Date).getTime(),
                            pos: t
                        }),
                        this.getContent()) : (this.pagination.setPage(n),
                        this.getPagePos(n))
                    }
                    ,
                    o.prototype.getPagePos = function(t) {
                        for (var e = t * this.pagination.pageStep, n = this.element.querySelectorAll(".content-inner p"), o = "", i = 0; i < n.length; i++)
                            if (n[i].offsetTop >= e) {
                                o = n[i].innerHTML;
                                break
                            }
                        t = this.content.indexOf(o);
                        this.progress = (0,
                        r.changeValueWithNewObj)(this.progress, {
                            time: (new Date).getTime(),
                            pos: t
                        })
                    }
                    ,
                    o.prototype.setPageByProgress = function() {
                        var t = this.content.slice(0, this.progress.pos).split("\n").length - 1
                          , t = this.element.querySelectorAll(".content-inner p")[t].offsetTop
                          , t = Math.floor(t / this.pagination.pageStep);
                        this.pagination.setPage(t),
                        this.progress.pos > this.content.length && this.getPagePos(t)
                    }
                    ,
                    o.prototype.getArticle = function(e) {
                        var n = this;
                        !0 === this.loading ? window.Message.add({
                            content: "正在加载章节内容"
                        }) : (this.loading = !0,
                        window.Api.getArticle(this.currentBook.source, this.progress.index, {
                            success: function(t) {
                                n.loading = !1,
                                n.content = t.data,
                                window.Store.set("a_".concat(n.currentBook.id, "_").concat(n.progress.index), n.content),
                                e && e()
                            },
                            error: function(t) {
                                n.loading = !1
                            }
                        }))
                    }
                    ,
                    n.default = o
                }
                , {
                    "../common/bar/bar": 6,
                    "../common/common": 8,
                    "../common/pagination/pagination": 13
                }],
                3: [function(t, e, n) {
                    "use strict";
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    });
                    var o = t("../common/bar/bar")
                      , i = t("../common/common")
                      , c = t("../common/pagination/pagination");
                    function r() {
                        var r = this;
                        this.bookMap = {},
                        this.bookList = [],
                        this.loading = !1,
                        this.element = document.querySelector(".page.bookshelf"),
                        this.pagination = new c.default({
                            root: this.element.querySelector(".content")
                        }),
                        this.bar = new o.default({
                            element: this.element.querySelector(".bar"),
                            pagination: this.pagination
                        }),
                        this.bookList = window.Store.getObj("bookshelf") || [],
                        window.Bind.bindView(this.element.querySelector(".book-list"), this, "bookList", function(t, e) {
                            r.compareBookList(t, e = void 0 === e ? [] : e);
                            var e = r.element.querySelector(".pagination-box").offsetHeight / 4
                              , n = 3 * e / 4
                              , o = Math.floor(r.element.querySelector(".book-list").offsetWidth / 2)
                              , i = "\n                <style>\n                    .book-item {height: ".concat(e, "px;}\n                    .book-item .book-cover {width: ").concat(n, "px;}\n                    .book-item .book-info {width: ").concat(o - n - 30, "px;}\n                </style>\n            ");
                            return t.forEach(function(t) {
                                var e = new Date(t.latestChapterTime)
                                  , n = window.Store.getObj("p_".concat(t.id));
                                i += '\n                    <div class="book-item" key="'.concat(t.id, '">\n                        <div class="book-cover" style="background-image: url(').concat(t.customCoverUrl, ');">\n                            <img src="').concat(t.coverUrl, '" alt="').concat(t.name, '"/>\n                        </div>\n                        <div class="book-info">\n                            <div class="book-name">').concat(t.name, '</div>\n                            <div class="book-author">').concat(t.author, '</div>\n                            <div class="book-dur">').concat(n.title, '</div>\n                            <div class="book-latest">').concat(t.latestChapterTitle, '</div>\n                            <div class="book-latest-time">更新时间：').concat(e.getFullYear(), "-").concat(e.getMonth() + 1, "-").concat(e.getDay(), "</div>\n                        </div>\n                    </div>\n                ")
                            }),
                            window.setTimeout(function() {
                                r.pagination.checkPage()
                            }),
                            i
                        }),
                        window.Router.cbMap.bookshelf = function() {
                            r.bookList = [].concat(r.bookList)
                        }
                    }
                    r.prototype.bookDelete = function(t, e) {
                        e || window.Store.del("p_".concat(t.id)),
                        window.Store.del("c_".concat(t.id)),
                        window.Store.getByHead("a_".concat(t.id)).forEach(function(t) {
                            return window.Store.del(t)
                        })
                    }
                    ,
                    r.prototype.compareBookList = function(t, e) {
                        var n = this
                          , o = this.bookMap;
                        this.bookMap = {},
                        t.forEach(function(t) {
                            n.bookMap[t.id] = t,
                            o[t.id] && (t.source !== o[t.id].source && n.bookDelete(o[t.id], !0),
                            delete o[t.id])
                        }),
                        Object.keys(o).forEach(function(t) {
                            n.bookDelete(o[t])
                        })
                    }
                    ,
                    r.prototype.getBookShelf = function() {
                        var e = this;
                        !0 === this.loading ? window.Message.add({
                            content: "正在加载书架数据"
                        }) : (this.loading = !0,
                        window.Api.getBookshelf({
                            success: function(t) {
                                e.loading = !1;
                                t = t.data.map(function(t) {
                                    var e = window.Store.compress("".concat(t.name, "_").concat(t.author))
                                      , n = (0,
                                    i.getObject)(t, [], {
                                        index: t.durChapterIndex,
                                        pos: t.durChapterPos,
                                        time: new Date(t.durChapterTime).getTime(),
                                        title: t.durChapterTitle
                                    })
                                      , o = window.Store.getObj("p_".concat(e));
                                    return (!o || o.time < n.time) && window.Store.setObj("p_".concat(e), n),
                                    (0,
                                    i.getObject)(t, ["name", "author", "coverUrl", "customCoverUrl", "latestChapterTime", "latestChapterTitle"], {
                                        id: e,
                                        source: t.bookUrl
                                    })
                                });
                                e.bookList = [].concat(t),
                                window.Store.setObj("bookshelf", e.bookList)
                            },
                            error: function(t) {
                                e.loading = !1
                            }
                        }))
                    }
                    ,
                    r.prototype.clickItem = function(t) {
                        t = (0,
                        i.getSpecialParent)(t.target || t.srcElement, function(t) {
                            return t.classList.contains("book-item")
                        }).getAttribute("key");
                        window.Store.set("current", t),
                        window.Router.go("article")
                    }
                    ,
                    n.default = r
                }
                , {
                    "../common/bar/bar": 6,
                    "../common/common": 8,
                    "../common/pagination/pagination": 13
                }],
                4: [function(t, e, n) {
                    "use strict";
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    });
                    var o = t("../common/bar/bar")
                      , i = t("../common/common")
                      , r = t("../common/pagination/pagination");
                    function c() {
                        function t() {
                            i.checkCurrent(),
                            i.checkHeight()
                        }
                        var i = this
                          , e = (this.list = [],
                        this.pageList = [],
                        this.oo = 10,
                        this.loading = !1,
                        this.cacheFlag = !1,
                        this.element = document.querySelector(".page.catalogue"),
                        this.pagination = new r.default({
                            root: this.element.querySelector(".content"),
                            fake: !0,
                            pageChange: function(t) {
                                t *= i.linePerPage;
                                i.pageList = i.list.slice(t, t + i.linePerPage)
                            }
                        }),
                        this.bar = new o.default({
                            element: this.element.querySelector(".bar"),
                            pagination: this.pagination
                        }),
                        this.element.querySelector(".current-info"));
                        window.Bind.bind(this, "list", function(t) {
                            i.linePerPage && (i.pagination.checkPage(Math.ceil(t.length / i.linePerPage)),
                            i.pagination.setPage(Math.floor(i.progress.index / i.linePerPage)))
                        }),
                        window.Bind.bindView(this.element.querySelector(".article-list"), this, "pageList", function(t) {
                            var o = "\n                <style>\n                    .article-item {line-height: 80px;}\n                </style>\n            ";
                            return t.forEach(function(t) {
                                var e = t.index === i.progress.index ? "current" : ""
                                  , n = window.Store.has("a_".concat(i.currentBook.id, "_").concat(t.index)) ? "cached" : "";
                                o += '\n                    <div class="article-item '.concat(e, " ").concat(n, '" key="').concat(t.index, '">').concat(t.title, "</div>\n                ")
                            }),
                            o
                        }),
                        window.Bind.bindView(e, this, "currentBook", function() {
                            var t;
                            return "".concat(null == (t = i.currentBook) ? void 0 : t.name, " - ").concat(null == (t = i.currentBook) ? void 0 : t.author)
                        }),
                        window.Bind.bind(this, "progress", function(t, e) {
                            window.Store.setObj("p_".concat(i.currentBook.id), t)
                        });
                        (window.Router.cbMap.catalogue = t)()
                    }
                    c.prototype.checkCurrent = function() {
                        this.currentBook = window.BookShelf.bookMap[window.Store.get("current")],
                        this.currentBook ? (this.progress = window.Store.getObj("p_".concat(this.currentBook.id)),
                        this.list = window.Store.getObj("c_".concat(this.currentBook.id)) || [],
                        0 === this.list.length && this.getCatalogue()) : "catalogue" === window.Router.current && window.Router.go("bookshelf")
                    }
                    ,
                    c.prototype.checkHeight = function() {
                        var t = this.element.offsetHeight - 230 - 20
                          , e = t % 80
                          , n = (e < 10 && (e += 80),
                        this.oo = e,
                        this.linePerPage = 2 * Math.round((t - e) / 80),
                        this.element.querySelector(".current-info"))
                          , o = this.element.querySelector(".content");
                        n.style.height = "".concat(e, "px"),
                        n.style.lineHeight = "".concat(e, "px"),
                        o.style.height = "".concat(t - e + 20, "px")
                    }
                    ,
                    c.prototype.getCatalogue = function() {
                        var e = this;
                        !0 === this.loading ? window.Message.add({
                            content: "正在加载目录数据"
                        }) : (this.loading = !0,
                        window.Api.getCatalogue(this.currentBook.source, {
                            success: function(t) {
                                e.loading = !1,
                                e.list = t.data.map(function(t) {
                                    return {
                                        index: t.index,
                                        title: t.title
                                    }
                                }),
                                window.Store.setObj("c_".concat(e.currentBook.id), e.list)
                            },
                            error: function(t) {
                                e.loading = !1
                            }
                        }))
                    }
                    ,
                    c.prototype.clickItem = function(t) {
                        t = (0,
                        i.getSpecialParent)(t.target || t.srcElement, function(t) {
                            return t.classList.contains("article-item")
                        }),
                        t = parseInt(t.getAttribute("key"));
                        this.progress = (0,
                        i.changeValueWithNewObj)(this.progress, {
                            index: t,
                            title: this.list[t].title,
                            time: (new Date).getTime(),
                            pos: 0
                        }),
                        window.setTimeout(function() {
                            window.Router.go("article")
                        })
                    }
                    ,
                    c.prototype.makeCache = function(e, n) {
                        var o = this;
                        n < e ? (this.cacheFlag = !1,
                        window.Message.add({
                            content: "缓存任务完成"
                        })) : window.Store.has("a_".concat(this.currentBook.id, "_").concat(e)) ? this.makeCache(e + 1, n) : window.Api.getArticle(this.currentBook.source, e, {
                            success: function(t) {
                                window.Store.set("a_".concat(o.currentBook.id, "_").concat(e), t.data),
                                null != (t = o.element.querySelector('.article-item[key="'.concat(e, '"]'))) && t.classList.add("cached"),
                                o.makeCache(e + 1, n)
                            },
                            error: function(t) {
                                window.Message.add({
                                    content: "缓存章节《".concat(o.list[e].title, "》失败")
                                }),
                                o.makeCache(e + 1, n)
                            }
                        })
                    }
                    ,
                    c.prototype.doCache = function(t) {
                        var e, n;
                        this.cacheFlag ? window.Message.add({
                            content: "正在缓存，请勿重复操作"
                        }) : (this.checkCurrent(),
                        this.cacheFlag = !0,
                        e = null == (e = this.progress) ? void 0 : e.index,
                        n = (null == (n = this.list[this.list.length - 1]) ? void 0 : n.index) || 0,
                        "all" === t && (e = 0),
                        "number" == typeof t && (n = Math.min(n, e + t)),
                        this.makeCache(e, n))
                    }
                    ,
                    c.prototype.deleteCache = function(e) {
                        var n = this;
                        this.cacheFlag ? window.Message.add({
                            content: "正在缓存，禁用删除操作"
                        }) : (window.Store.getByHead("a_".concat(this.currentBook.id, "_")).filter(function(t) {
                            return !("readed" === e && parseInt(t.split("_")[2]) >= n.progress.index)
                        }).forEach(function(t) {
                            window.Store.del(t),
                            null != (t = n.element.querySelector('.article-item[key="'.concat(t.split("_")[2], '"]'))) && t.classList.remove("cached")
                        }),
                        window.Message.add({
                            content: "删除指定缓存完成"
                        }))
                    }
                    ,
                    c.prototype.cache = function() {
                        window.Modal.add({
                            content: '\n                <style>\n                    .modal-content .button {\n                        line-height: 60px;\n                        padding: 20px;\n                        width: 40%;\n                        float: left;\n                        margin: 10px;\n                    }\n                </style>\n                <div class="button" onclick="Catalogue.doCache(20)">缓存20章</div>\n                <div class="button" onclick="Catalogue.doCache(50)">缓存50章</div>\n                <div class="button" onclick="Catalogue.doCache(100)">缓存100章</div>\n                <div class="button" onclick="Catalogue.doCache(200)">缓存200章</div>\n                <div class="button" onclick="Catalogue.doCache(\'end\')">缓存未读</div>\n                <div class="button" onclick="Catalogue.doCache(\'all\')">缓存全文</div>\n                <div class="button" onclick="Catalogue.deleteCache(\'readed\')">删除已读</div>\n                <div class="button" onclick="Catalogue.deleteCache(\'all\')">删除全部</div>\n            '
                        })
                    }
                    ,
                    n.default = c
                }
                , {
                    "../common/bar/bar": 6,
                    "../common/common": 8,
                    "../common/pagination/pagination": 13
                }],
                5: [function(t, e, n) {
                    "use strict";
                    function o() {
                        if (this.apiMap = {
                            bookshelf: "/getBookshelf",
                            catalogue: "/getChapterList",
                            article: "/getBookContent",
                            save: "/saveBookProgress"
                        },
                        window.Api)
                            throw Error("api has been inited");
                        (window.Api = this).url = window.Store.get("url") || ""
                    }
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    }),
                    o.prototype.saveProgress = function(t, e, n) {
					
    var base_url = this.url + this.apiMap.save;
    var timestamp = new Date().getTime();
    var separator = '?'//  var separator = base_url.includes('?') ? '&' : '?'; // 检查URL是否已包含查询参数
    var url_with_timestamp = base_url + separator + 'v=' + timestamp;

    this.post(url_with_timestamp, {
						 url: t.source,
						 index: e.index

                        }, {
                            success: function(t) {
                                n && n.success && n.success(t)
                            },
                            error: function(t) {
                                console.log(t),
                                n && n.error && n.error(t),
                                window.Message.add({
                                    content: "保存阅读进度到服务端失败"
                                })
                            }
                        })
                    }
                    ,
                    o.prototype.getArticle = function(t, e, n) {
						var base_url = this.url + this.apiMap.article;
                        var timestamp = new Date().getTime();
                        var separator = '?'//  var separator = base_url.includes('?') ? '&' : '?'; // 检查URL是否已包含查询参数
                        var url_with_timestamp = base_url + separator + 'v=' + timestamp;
                        this.post(url_with_timestamp, {
                            url: t,
                            index: e
                        }, {
                            success: function(t) {
                                n && n.success && n.success(t)
                            },
                            error: function(t) {
                                console.log(t),
                                n && n.error && n.error(t),
                                window.Message.add({
                                    content: "获取章节内容失败"
                                })
                            }
                        })
                    }
                    ,
                    o.prototype.getCatalogue = function(t, e) {
						var base_url = this.url + this.apiMap.catalogue;
                        var timestamp = new Date().getTime();
                        var separator = '?'//   var separator = base_url.includes('?') ? '&' : '?'; // 检查URL是否已包含查询参数
                        var url_with_timestamp = base_url + separator + 'v=' + timestamp;
                        this.post(url_with_timestamp, {                        
                            url: t,
                            refresh: 0
                        }, {
                            success: function(t) {
                                e && e.success && e.success(t)
                            },
                            error: function(t) {
                                console.log(t),
                                e && e.error && e.error(t),
                                window.Message.add({
                                    content: "获取目录内容失败"
                                })
                            }
                        })
                    }
                    ,
                    o.prototype.getBookshelf = function(e) {
                        this.get(this.url + this.apiMap.bookshelf, {}, {
                            success: function(t) {
                                e && e.success && e.success(t)
                            },
                            error: function(t) {
                                console.log(t),
                                e && e.error && e.error(t),
                                window.Message.add({
                                    content: "获取书架内容失败"
                                })
                            }
                        })
                    }
                    ,
                    o.prototype.post = function(t, e, n) {
                        return this.http("POST", t, e, n)
                    }
                    ,
                    o.prototype.get = function(t, e, n) {
                        return this.http("GET", t, e, n)
                    }
                    ,
                    o.prototype.http = function(t, e, n, o) {
                        var i, r;
                        if (this.url || o && o.check)
                            return i = new XMLHttpRequest,
                            r = Object.keys(n).map(function(t) {
                                return "".concat(t, "=").concat(n[t])
                            }).join("&"),
                            i.open(t, "GET" === t ? "".concat(e, "?").concat(r) : e),
                            "POST" === t && i.setRequestHeader("Content-Type", "application/json; charset=UTF-8"),
                            i.send("GET" === t ? null : JSON.stringify(n)),
                            i.onreadystatechange = function() {
                                if (4 === this.readyState) {
                                    var e = void 0;
                                    try {
                                        e = JSON.parse(this.responseText)
                                    } catch (t) {
                                        e = this.responseText
                                    }
                                    200 === this.status && e.isSuccess ? o && o.success && o.success(e) : o && o.error && o.error(e)
                                }
                            }
                            ,
                            i;
                        window.Message.add({
                            content: "当前未配置服务器地址"
                        }),
                        o && o.error && o.error(null)
                    }
                    ,
                    o.prototype.setUrl = function(t) {
                        this.url = t,
                        window.Store.set("url", t)
                    }
                    ,
                    o.prototype.checkUrl = function(e) {
                        var n = this;
                        this._checkXHR && this._checkXHR.abort(),
                        this._checkXHR = this.get(e + this.apiMap.bookshelf, {}, {
                            success: function(t) {
                                window.Message.add({
                                    content: "服务器地址测试成功"
                                }),
                                n.setUrl(e)
                            },
                            error: function(t) {
                                console.log(t),
                                window.Message.add({
                                    content: "服务器地址测试失败"
                                })
                            },
                            check: !0
                        })
                    }
                    ,
                    n.default = o
                }
                , {}],
                6: [function(t, e, n) {
                    "use strict";
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    }),
                    n.default = function(t) {
                        var n = this
                          , t = (this.element = t.element,
                        this.pagination = t.pagination,
                        this.percent = 0,
                        this.element.innerHTML = '\n                <div class="bar-progress"></div>\n                <div class="bar-text"><span class="bar-current"></span>/<span class="bar-total"></span></div>\n            ',
                        this.element.querySelector(".bar-current"))
                          , e = this.element.querySelector(".bar-total")
                          , o = this.element.querySelector(".bar-progress");
                        window.Bind.bindView(t, this.pagination, "pageIndex", function(t) {
                            t += 1;
                            return n.percent = t / n.pagination.pageLimit,
                            t
                        }),
                        window.Bind.bindView(e, this.pagination, "pageLimit", function(t) {
                            return n.percent = (n.pagination.pageIndex + 1) / t,
                            t
                        }),
                        window.Bind.bindStyle(o, this, "percent", "width", function(t) {
                            return "".concat(100 * t, "%")
                        }),
                        this.element.onclick = function(t) {
                            var e = n.element.offsetWidth
                              , t = t.pageX
                              , t = Math.floor(n.pagination.pageLimit * t / e);
                            n.pagination.setPage(t)
                        }
                    }
                }
                , {}],
                7: [function(t, e, n) {
                    "use strict";
                    function o() {
                        if (this.cbMap = {},
                        this.objIndex = 0,
                        this.objMap = {},
                        window.Bind)
                            throw Error("bind has been inited");
                        window.Bind = this
                    }
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    }),
                    o.prototype.handleObj = function(n, o) {
                        var i, r = this;
                        n.hasOwnProperty("_bindId") || (n._bindId = this.objIndex++),
                        this.cbMap[n._bindId + o] || (n[i = "_" + o] = n[o],
                        this.cbMap[n._bindId + o] = [],
                        Object.defineProperty(n, o, {
                            get: function() {
                                return n[i]
                            },
                            set: function(t) {
                                var e = n[i];
                                n[i] = t,
                                r.run(n, o, t, e)
                            }
                        }))
                    }
                    ,
                    o.prototype.bindInput = function(n, e, o) {
                        if (!n)
                            throw new Error("element is null");
                        this.bind(e, o, function(t, e) {
                            n.value = t
                        }, !0),
                        n.onchange = function(t) {
                            e[o] = t.target.value
                        }
                    }
                    ,
                    o.prototype.bindStyle = function(n, t, e, o, i) {
                        if (!n)
                            throw new Error("element is null");
                        this.bind(t, e, function(t, e) {
                            n.style[o] = i ? i(t, e) : t
                        }, !0)
                    }
                    ,
                    o.prototype.bindView = function(n, t, e, o) {
                        if (!n)
                            throw new Error("element is null");
                        this.bind(t, e, function(t, e) {
                            n.innerHTML = o ? o(t, e) : t
                        }, !0)
                    }
                    ,
                    o.prototype.bind = function(t, e, n, o) {
                        this.handleObj(t, e),
                        this.cbMap[t._bindId + e].push(n),
                        o && n(t[e], void 0)
                    }
                    ,
                    o.prototype.run = function(t, e, n, o) {
                        this.cbMap[t._bindId + e].forEach(function(t) {
                            try {
                                t(n, o)
                            } catch (t) {
                                throw t
                            }
                        })
                    }
                    ,
                    n.default = o
                }
                , {}],
                8: [function(t, e, n) {
                    "use strict";
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    }),
                    n.changeValueWithNewObj = n.getObject = n.getSpecialParent = n.makeDisplayText = n.strToDom = void 0,
                    n.strToDom = function(t) {
                        var e = document.createElement("div");
                        return e.innerHTML = t,
                        e.children
                    }
                    ,
                    n.makeDisplayText = function(t) {
                        return new Array(t + 1).join("测试文本")
                    }
                    ,
                    n.getSpecialParent = function t(e, n) {
                        return e && e !== document && n(e) ? e : (e = e.parentElement || e.parentNode) ? t(e, n) : null
                    }
                    ,
                    n.getObject = function(e, t, n) {
                        var o = {};
                        return t.forEach(function(t) {
                            o[t] = e[t]
                        }),
                        n && Object.keys(n).forEach(function(t) {
                            o[t] = n[t]
                        }),
                        o
                    }
                    ,
                    n.changeValueWithNewObj = function(t, e) {
                        var n = JSON.parse(JSON.stringify(t));
                        return Object.keys(e).forEach(function(t) {
                            n[t] = e[t]
                        }),
                        n
                    }
                }
                , {}],
                9: [function(t, e, n) {
                    "use strict";
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    }),
                    n.default = function() {
                        window.onerror = function(t) {
                            console.error(t),
                            window.Modal && window.Modal.add({
                                content: t.toString()
                            })
                        }
                    }
                }
                , {}],
                10: [function(t, e, n) {
                    "use strict";
                    function o() {
                        if (this.limit = {
                            fontSize: 20,
                            lineHeight: 24
                        },
                        this.base = {
                            fontSize: 30,
                            lineHeight: 40
                        },
                        window.Layout)
                            throw Error("layout has been inited");
                        (window.Layout = this).fontSize = parseInt(window.Store.get("fontSize") || this.base.fontSize.toString()),
                        this.lineHeight = parseInt(window.Store.get("lineHeight") || this.base.lineHeight.toString())
                    }
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    }),
                    o.prototype.set = function(t, e) {
                        this[t] = e || this.base[t],
                        window.Store.set(t, this[t].toString())
                    }
                    ,
                    o.prototype.add = function(t, e) {
                        var n = this[t];
                        (n += e) < this.limit[t] && (n = this.limit[t]),
                        this.set(t, n)
                    }
                    ,
                    o.prototype.reset = function(t) {
                        t ? this.set(t) : (this.set("fontSize"),
                        this.set("lineHeight"))
                    }
                    ,
                    n.default = o
                }
                , {}],
                11: [function(t, e, n) {
                    "use strict";
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    });
                    var o = t("../common")
                      , i = (r.prototype.remove = function() {
                        var t = this.body.parentElement;
                        t && t.removeChild(this.body)
                    }
                    ,
                    r);
                    function r(t) {
                        var e = this
                          , n = (0,
                        o.strToDom)('\n            <div class="message">\n                <div class="message-content">\n                </div>\n            </div>\n        ')[0]
                          , n = (this.body = n).querySelector(".message-content");
                        n.innerHTML = t.content,
                        n.onclick = function() {
                            t.onOk && t.onOk(),
                            e.remove()
                        }
                        ,
                        t.banAutoRemove || window.setTimeout(function() {
                            t.onCancle && t.onCancle(),
                            e.remove()
                        }, 2e3)
                    }
                    function c() {
                        if (window.Message)
                            throw Error("modal has been inited");
                        this.list = [],
                        (window.Message = this).element = document.querySelector(".message-box")
                    }
                    c.prototype.add = function(t) {
                        t = new i(t);
                        return this.list.push(t),
                        this.element.appendChild(t.body),
                        t
                    }
                    ,
                    c.prototype.remove = function(t) {
                        t.remove();
                        t = this.list.indexOf(t);
                        this.list.splice(t, 1)
                    }
                    ,
                    c.prototype.clear = function() {
                        this.list = [],
                        this.element.innerHTML = ""
                    }
                    ,
                    n.default = c
                }
                , {
                    "../common": 8
                }],
                12: [function(t, e, n) {
                    "use strict";
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    });
                    var r = t("../common")
                      , o = (i.prototype.remove = function() {
                        this.body.parentElement.removeChild(this.body)
                    }
                    ,
                    i);
                    function i(t) {
                        var e = this
                          , n = (this.zIndex = t.zIndex,
                        '\n            <div class="modal" style="z-index: '.concat(this.zIndex, ';">\n                <div class="modal-content">\n                </div>\n                <div class="modal-footer">\n                    <div class="button modal-confirm">确定</div>\n                    <div class="button modal-cancel">取消</div>\n                </div>\n            </div>\n        '))
                          , n = (0,
                        r.strToDom)(n)[0]
                          , o = (this.body = n).querySelector(".modal-content")
                          , i = n.querySelector(".modal-confirm")
                          , n = n.querySelector(".modal-cancel");
                        "string" == typeof t.content ? o.innerHTML = t.content : o.appendChild(t.content),
                        n.onclick = function() {
                            t.onCancel && t.onCancel(),
                            e.remove()
                        }
                        ,
                        i.onclick = function() {
                            t.onOk && t.onOk(),
                            e.remove()
                        }
                    }
                    function c() {
                        if (this.list = [],
                        window.Modal)
                            throw Error("modal has been inited");
                        (window.Modal = this).element = document.querySelector(".modal-box")
                    }
                    c.prototype.add = function(t) {
                        "zIndex"in t || (e = this.list.length,
                        t.zIndex = (e ? this.list[e - 1].zIndex : 100) + 1);
                        var e = new o(t);
                        return this.list.push(e),
                        this.element.appendChild(e.body),
                        e
                    }
                    ,
                    c.prototype.remove = function(t) {
                        t.remove();
                        t = this.list.indexOf(t);
                        this.list.splice(t, 1)
                    }
                    ,
                    c.prototype.clear = function() {
                        this.list = [],
                        this.element.innerHTML = ""
                    }
                    ,
                    n.default = c
                }
                , {
                    "../common": 8
                }],
                13: [function(t, e, n) {
                    "use strict";
                    function o(e) {
                        var n = this;
                        this.pageIndex = 0,
                        this.pageLimit = 1,
                        this.pagePadding = 0,
                        this.fakePage = !1,
                        this.root = e.root,
                        this.handleHtml(e.root),
                        this.fakePage = e.fake || !1,
                        this.pageStep = this.box.offsetHeight,
                        this.checkPage(),
                        window.Bind.bindStyle(this.padding, this, "pagePadding", "height", function(t) {
                            return "".concat(t, "px")
                        }),
                        window.Bind.bind(this, "pageIndex", function(t) {
                            n.fakePage ? null != e && e.pageChange(t) : n.box.scrollTop = n.pageStep * t
                        })
                    }
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    }),
                    o.prototype.handleHtml = function(t) {
                        var e = t.innerHTML;
                        t.innerHTML = '\n            <div class="pagination-box">\n                <div class="pagination-body">\n                    <div class="pagination-content"></div>\n                    <div class="pagination-padding"></div>\n                </div>\n            </div>',
                        t.querySelector(".pagination-content").innerHTML = e,
                        this.box = t.querySelector(".pagination-box"),
                        this.padding = t.querySelector(".pagination-padding")
                    }
                    ,
                    o.prototype.checkPage = function(t) {
                        this.pageStep = this.box.offsetHeight,
                        this.fakePage ? (this.pageLimit = t || 1,
                        this.pagePadding = 0) : (this.pageLimit = Math.ceil(this.box.scrollHeight / this.pageStep) || 1,
                        this.pagePadding = this.pageStep * this.pageLimit - this.box.scrollHeight)
                    }
                    ,
                    o.prototype.setPage = function(t) {
                        var e = t < 0 ? 0 : t;
                        t >= this.pageLimit && (e = this.pageLimit - 1),
                        this.pageIndex = e
                    }
                    ,
                    o.prototype.pageChange = function(t) {
                        this.setPage(this.pageIndex + t)
                    }
                    ,
                    n.default = o
                }
                , {}],
                14: [function(t, e, n) {
                    "use strict";
                    function o(t) {
                        var o = this;
                        if (this.pages = [],
                        this.cbMap = {},
                        window.Router)
                            throw Error("router has been inited");
                        (window.Router = this).pages = t;
                        function e(t) {
                            var e = window.location.hash
                              , n = e.lastIndexOf("#");
                            -1 < n && (e = e.slice(n + 1)),
                            0 !== o.pages.length && (-1 === o.pages.indexOf(e) ? window.location.hash = o.pages[0] : o.switchPage(e))
                        }
                        (window.onhashchange = e)()
                    }
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    }),
                    o.prototype.switchPage = function(t) {
                        var e;
                        null != (e = document.querySelector(".show")) && e.classList.remove("show"),
                        null != (e = document.querySelector(".".concat(t))) && e.classList.add("show"),
                        this.current = t,
                        this.cbMap[t] && this.cbMap[t]()
                    }
                    ,
                    o.prototype.go = function(t) {
                        window.location.hash = t
                    }
                    ,
                    n.default = o
                }
                , {}],
                15: [function(t, e, n) {
                    "use strict";
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    });
                    var i = t("lz-string");
                    function o() {
                        if (this.limitChecking = !1,
                        this.limit = 0,
                        this.usage = 0,
                        this.percent = 0,
                        this.compress = i.compress,
                        this.decompress = i.decompress,
                        window.Store)
                            throw Error("store has been inited");
                        (window.Store = this).limit = parseInt(this.get("limit") || "0"),
                        this.checkUsage(),
                        0 === this.limit && window.Message.add({
                            content: "缓存未初始化请手动检测"
                        })
                    }
                    o.prototype.bookDelete = function(t, e) {
                        var n = this;
                        e || this.del("p_".concat(t.id)),
                        this.del("c_".concat(t.id)),
                        this.getByHead("a_".concat(t.id)).forEach(function(t) {
                            return n.del(t)
                        })
                    }
                    ,
                    o.prototype.del = function(t) {
                        localStorage.removeItem(t),
                        this.checkUsage()
                    }
                    ,
                    o.prototype.has = function(t) {
                        return localStorage.hasOwnProperty(t)
                    }
                    ,
                    o.prototype.getObj = function(t) {
                        return JSON.parse(this.get(t))
                    }
                    ,
                    o.prototype.setObj = function(t, e, n) {
                        this.set(t, JSON.stringify(e), n)
                    }
                    ,
                    o.prototype.set = function(t, e, n) {
                        try {
                            var o = (0,
                            i.compress)(e);
                            localStorage.setItem(t, o),
                            this.checkUsage(),
                            n && n.success && n.success()
                        } catch (t) {
                            window.Message.add({
                                content: "缓存失败，空间不足"
                            }),
                            n && n.fail && n.fail()
                        }
                    }
                    ,
                    o.prototype.get = function(t) {
                        t = localStorage.getItem(t);
                        return t ? (0,
                        i.decompress)(t) : null
                    }
                    ,
                    o.prototype.getByHead = function(e) {
                        return Object.keys(localStorage).filter(function(t) {
                            return 0 === t.indexOf(e)
                        })
                    }
                    ,
                    o.prototype.checkUsage = function() {
                        var t = this;
                        this.checkFlag && window.clearTimeout(this.checkFlag),
                        this.checkFlag = window.setTimeout(function() {
                            t.usage = Object.keys(localStorage).map(function(t) {
                                return t + localStorage.getItem(t)
                            }).join("").length,
                            t.percent = t.limit ? Math.round(t.usage / t.limit * 100) : 0,
                            95 < t.percent && window.Message.add({
                                content: "缓存已使用".concat(t.percent, "%，请注意")
                            })
                        }, 500)
                    }
                    ,
                    o.prototype.checkLimit = function() {
                        var i = this;
                        window.Message.add({
                            content: "正在检测缓存容量"
                        }),
                        this.limitChecking || (this.limitChecking = !0,
                        window.setTimeout(function() {
                            for (var t = i.usage, e = 1e6, n = 0; 2 < e; )
                                try {
                                    var o = "_test".concat(n++);
                                    if (e < o.length)
                                        break;
                                    localStorage.setItem(o, new Array(e - o.length + 1).join("a")),
                                    t += e
                                } catch (t) {
                                    console.log(t),
                                    n--,
                                    e = Math.round(e / 2)
                                }
                            i.limit = t,
                            i.getByHead("_test").forEach(function(t) {
                                i.del(t)
                            }),
                            i.set("limit", i.limit.toString()),
                            i.limitChecking = !1,
                            window.Message.add({
                                content: "检测完成"
                            })
                        }, 1e3))
                    }
                    ,
                    n.default = o
                }
                , {
                    "lz-string": 1
                }],
                16: [function(t, e, n) {
                    "use strict";
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    });
                    var o = t("../common/common");
                    function i() {
                        this.element = document.querySelector(".page.config"),
                        this.url = 'http://reader3地址:端口/reader3',
                        this.displayText = (0,
                        o.makeDisplayText)(200),
                        window.Bind.bindInput(this.element.querySelector(".url input"), this, "url"),
                        window.Bind.bindView(this.element.querySelector(".store-usage"), window.Store, "usage"),
                        window.Bind.bindView(this.element.querySelector(".store-total"), window.Store, "limit"),
                        window.Bind.bindView(this.element.querySelector(".store-percent"), window.Store, "percent", function(t) {
                            return "  ( ".concat(t, "% )")
                        }),
                        window.Bind.bindView(this.element.querySelector(".font-size"), window.Layout, "fontSize"),
                        window.Bind.bindView(this.element.querySelector(".line-height"), window.Layout, "lineHeight");
                        var t = this.element.querySelector(".display .text p");
                        window.Bind.bindView(t, this, "displayText"),
                        window.Bind.bindStyle(t, window.Layout, "fontSize", "fontSize", function(t) {
                            return "".concat(t, "px")
                        }),
                        window.Bind.bindStyle(t, window.Layout, "lineHeight", "lineHeight", function(t) {
                            return "".concat(t, "px")
                        }),
                        this.url ? this.checkUrl() : window.Message.add({
                            content: "当前未配置服务器地址"
                        })
                    }
                    i.prototype.checkUrl = function() {
                        window.Api.checkUrl(this.url)
                    }
                    ,
                    n.default = i
                }
                , {
                    "../common/common": 8
                }],
                17: [function(t, e, n) {
                    "use strict";
                    Object.defineProperty(n, "__esModule", {
                        value: !0
                    });
                    var o = t("./bookshelf/bookshelf")
                      , i = t("./config/config")
                      , r = t("./common/router/router")
                      , c = t("./common/debugger/debugger")
                      , a = t("./common/modal/modal")
                      , s = t("./common/message/message")
                      , l = t("./common/store/store")
                      , u = t("./common/bind/bind")
                      , d = t("./common/layout/layout")
                      , h = t("./common/api/api")
                      , p = t("./article/article")
                      , g = t("./catalogue/catalogue")
                      , f = ["config", "bookshelf", "article", "catalogue"];
                    window.init = function() {
                        new c.default,
                        new u.default,
                        new a.default,
                        new s.default,
                        new r.default(f),
                        new l.default,
                        new d.default,
                        new h.default,
                        document.querySelector(".global-style").innerHTML = "\n        <style>\n            .page .content {\n                height: ".concat(document.body.offsetHeight - 230, "px;\n            }\n        </style>\n    "),
                        window.Config = new i.default,
                        window.BookShelf = new o.default,
                        window.Catalogue = new g.default,
                        window.Article = new p.default
                    }
                    ,
                    window.ondblclick = function(t) {
                        t.preventDefault()
                    }
                }
                , {
                    "./article/article": 2,
                    "./bookshelf/bookshelf": 3,
                    "./catalogue/catalogue": 4,
                    "./common/api/api": 5,
                    "./common/bind/bind": 7,
                    "./common/debugger/debugger": 9,
                    "./common/layout/layout": 10,
                    "./common/message/message": 11,
                    "./common/modal/modal": 12,
                    "./common/router/router": 14,
                    "./common/store/store": 15,
                    "./config/config": 16
                }]
            }, {}, [17]);
        </script>
        <!-- endinject -->
    </head>
    <body onload="init()">
        <div class="global-style"></div>
        <div class="page bookshelf show">
            <div class="content">
                <div class="book-list" onclick="BookShelf.clickItem(event)"></div>
            </div>
            <div class="bar"></div>
            <div class="control">
                <div class="left-box">
                    <div class="button" onclick="Router.go('config')">配置</div>
                    <div class="button" onclick="BookShelf.getBookShelf()">刷新</div>
                </div>
                <div class="right-box">
                    <div class="button" onclick="BookShelf.pagination.pageChange(-1)">&lt;</div>
                    <div class="button" onclick="BookShelf.pagination.pageChange(1)">&gt;</div>
                </div>
            </div>
        </div>
        <div class="page article">
            <div class="content">
                <div class="content-inner"></div>
            </div>
            <div class="current-info"></div>
            <div class="bar"></div>
            <div class="control">
                <div class="left-box">
                    <div class="button" onclick="Router.go('bookshelf')">书架</div>
                    <div class="button" onclick="Router.go('catalogue')">目录</div>
                    <div class="button" onclick="Article.getArticle()">刷新</div>
                </div>
                <div class="right-box">
                    <div class="button" onclick="Article.pageChange(-1)">&lt;</div>
                    <div class="button" onclick="Article.pageChange(1)">&gt;</div>
                </div>
            </div>
        </div>
        <div class="page catalogue">
            <div class="content">
                <div class="article-list" onclick="Catalogue.clickItem(event)"></div>
            </div>
            <div class="current-info"></div>
            <div class="bar"></div>
            <div class="control">
                <div class="left-box">
                    <div class="button" onclick="Router.go('bookshelf')">书架</div>
                    <div class="button" onclick="Router.go('article')">文章</div>
                    <div class="button" onclick="Catalogue.getCatalogue()">刷新</div>
                    <div class="button" onclick="Catalogue.cache()">缓存</div>
                </div>
                <div class="right-box">
                    <div class="button" onclick="Catalogue.pagination.pageChange(-1)">&lt;</div>
                    <div class="button" onclick="Catalogue.pagination.pageChange(1)">&gt;</div>
                </div>
            </div>
        </div>
        <div class="page config">
            <div class="content">
                <div class="form-item url">
                    <div class="label">服务器地址</div>
                    <div class="text">
                        <input type="text" placeholder="请输入阅读服务地址"/>
                        <div class="button right" onclick="Config.checkUrl()">测试</div>
                    </div>
                </div>
                <div class="form-item">
                    <div class="label">缓存容量</div>
                    <div class="text">
                        <span class="store-usage">-</span>
                        <span class="store-division">/</span>
                        <span class="store-total">-</span>
                        <span class="store-percent"></span>
                        <div class="button right" onclick="Store.checkLimit()">检测</div>
                    </div>
                </div>
                <div class="form-item">
                    <div class="label">字号</div>
                    <div class="text">
                        <span class="font-size">16</span>
                        <span class="font-unit">px</span>
                        <div class="button right" onclick="Layout.reset('fontSize')">重置</div>
                        <div class="button right" onclick="Layout.add('fontSize', -1)">-</div>
                        <div class="button right" onclick="Layout.add('fontSize', 1)">+</div>
                    </div>
                </div>
                <div class="form-item">
                    <div class="label">行距</div>
                    <div class="text">
                        <span class="line-height">20</span>
                        <span class="line-unit">px</span>
                        <div class="button right" onclick="Layout.reset('lineHeight')">重置</div>
                        <div class="button right" onclick="Layout.add('lineHeight', -1)">-</div>
                        <div class="button right" onclick="Layout.add('lineHeight', 1)">+</div>
                    </div>
                </div>
                <div class="form-item display">
                    <div class="label">效果展示</div>
                    <div class="text">
                        <p>测试文本</p>
                    </div>
                </div>
            </div>
            <div class="control">
                <div class="left-box">
                    <div class="button" onclick="Router.go('bookshelf')">书架</div>
                </div>
                <div class="right-box">
                <!-- <div class="button" onclick="">保存</div> -->
                </div>
            </div>
        </div>
        <div class="modal-box"></div>
        <div class="message-box"></div>
    </body>
</html>

